<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <meta name="description" content="Intelligent Operation Center">
    <meta name="author" content="GaoJie ESRI China @ 2016">
    <link rel="icon" type="image/png" href="images/logo.png">
    <title>Intelligent Operation Center</title>
    <!-- Bootstrap core CSS -->
    <link href="libs/bootstrap-3.3.4/css/bootstrap.css" rel="stylesheet">
    <!-- font-awesome CSS -->
    <link href="libs/font-awesome/css/font-awesome.css" rel="stylesheet">
    <!-- animate CSS -->
    <link href="libs/animate/animate.min.css" rel="stylesheet">
    <!-- weather CSS -->
    <link href="libs/weather/screen.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="libs/xenon/css/xenon.css" type="text/css"> -->
    <!-- scrollbar CSS -->
    <link href="libs/scrollbar/jquery.mCustomScrollbar.min.css" rel="stylesheet">
    <!-- arcgis CSS -->
    <link href="https://js.arcgis.com/4.0/dijit/themes/claro/claro.css" rel="stylesheet" />
    <link href="https://js.arcgis.com/4.0/esri/css/main.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <title>城市地面塌陷风险体检平台</title> -->
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/component.css">
    <link rel=" stylesheet" href="css/custom.css">
    <link rel="stylesheet" href="css/normalize.css">


    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="./echarts-stat/dist/ecStat.js"></script>
    <script src="./echarts-stat/dist/ecStat.min.js"></script>


    <script src="js/layui.js"></script>
    <script src="js/jiangsu.js"></script>

    <script src="./layui-main/layui-main/dist/layui.js" charset="utf-8"></script>
    <link rel="stylesheet" href="layui-main\layui-main\dist\css\layui.css" media="all">
    <script src="js/usa.js" type="text/javascript" charset="utf-8"></script>

    <meta charset="UTF-8">
    <title data-i18n="resources.title_heatMap"></title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" rel="stylesheet">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script type="text/javascript" src="https://iclient.supermap.io/dist/leaflet/iclient-leaflet.js"></script>
    <script src="js/Leaflet.draw.js"></script>
    <script src="js/Leaflet-heat.js"></script>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" include="leaflet.heat" src="../../dist/leaflet/include-leaflet.js"></script>
    <style>
        #heatNumbers,
        #heatRadius {
            width: 50px;
            display: inline-block;
        }
    </style>

</head>

<body>
    <header>
        <!-- <h1>城市地面塌陷风险体检平台</h1>
        <div class="showTime">当前时间：2023年8月<span></span></div> -->

    </header>
    <!-- <div class="columnNav">
        <ul class="tabs">
            <li class="active"><a href="#tab1">功能区域</a></li>
            <li><a href="#tab2">地理探测器</a></li>
            <li><a href="#tab3">风险等级</a></li>
            <li><a href="#tab4">检查站分布</a></li>
            <li><a href="#tab5">设备分布</a></li>
            <li><a href="#tab6">水源分布</a></li>
        </ul>
    </div> -->

    <nav class="navbar navbar-glass navbar-fixed-top" style="background-color: #1C425A;">

        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">
                    <img alt="logo" src="images/logo.png">
                    <div class="navbar-title">
                        <span class="navbar-brand-text">城市地面塌陷协同挖掘与知识平台</span>
                        <span class="navbar-brand-subtext">Urban pavement collapse management system
                        </span>
                    </div>
                </a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="layui-nav nav navbar-nav navbar-left">
                    <li class="nav navbar-nav navbar-left layui-nav-item layui-this"><a href="#tab1">图表分析</a></li>
                    <li class="nav navbar-nav navbar-left layui-nav-item">
                        <a href="#tab2">地理探测器</a>
                    </li>
                    <li class="nav navbar-nav navbar-left layui-nav-item"><a href="nav.html">导航</a></li>
                    <li class="nav navbar-nav navbar-left layui-nav-item ">
                        <a href="javascript:;">子级</a>
                        <dl class="layui-nav-child ">

                            <dd><a href="index/index3.html">塌陷风险预测</a></dd>
                            <dd><a href="index/index4.html">地理探测器</a></dd>
                            <dd><a href="">菜单3</a></dd>

                        </dl>
                    </li>
                    <li class="nav navbar-nav navbar-left layui-nav-item">
                        <a href="javascript:;">选项</a>
                        <dl class="layui-nav-child">
                            <dd><a href="nav.html">选项1</a></dd>
                            <dd class="layui-this"><a href="nav.html">选项2</a></dd>
                            <dd><a href="nav.html">选项3</a></dd>
                        </dl>
                    </li>
                    <li class="nav navbar-nav navbar-left layui-nav-item"><a href="nav.html">演示</a></li>
                </ul>
            </div>
        </div>

    </nav>





    <div id="tab1" class="tab_content">
        <section class="mainbox">
            <div class=" map">
                <div id="map" style="margin:0 auto;width: 100%;height: 100%; z-index: 1"></div>
                <div class="map1"></div>
                <div class="map2"></div>
                <div class="map3"></div>
            </div>
            <div class="columnleft">
                <div class="panel bar">
                    <h2>塌陷新闻</h2>
                    <ul class="lbul" >
                        <div style="height: 100%; width:100%;display: flex; flex-direction:column"></div>
                    </ul>
                    <script>
                        const ul = document.querySelector("ul>div");
                        let dataArr = [];

                           // 添加数据
                        $.ajax({
                            url: "http://127.0.0.1:8000/daping/news_list",
                            dataType: "json",
                            async:false
                        }).done(function (data) {
                            //console.log('Data: ', data);
                            const xData = [];
                            const yData = [];
                            for (let i in data) {
                                if(data[i].pk!=null)
                                dataArr.push(data[i].fields.newsdate+data[i].fields.city+data[i].fields.district+data[i].pk);
                            }
        
                        });

           

                        // 初始渲染4条数据
                        for (let i = 0; i < 8; i++) {
                            const li = document.createElement("li1");
                            li.innerHTML = dataArr[i];
                            ul.appendChild(li);
                        }
                    </script>
                </div>
                <div class="panel line">
                    <h2>因子探测器</h2>
                    <div class="chart"></div>
                </div>
                <!-- <div class="panel pie">
                    <h2>饼形图-工程师年龄分布</h2>
                    <div class="chart"></div>
                </div> -->
            </div>
            <div class="columnright">

                <div class="panel bar1">
                    <h2>风险点排行</h2>
                    <div class="chart"></div>
                </div>
                <div class="panel line1">
                    <h2>历史地面塌陷情况</h2>
                    <div class="chart"></div>

                </div>
                <div class="panel pie1">
                    <h2>塌陷原因分类</h2>
                    <div class="chart"></div>
                </div>
            </div>
        </section>
    </div>

    <div id="tab2" class="tab_content">
        <section class="mainbox">
            <div class=" map">
                <div class="chart"></div>
                <div class="map1"></div>
                <div class="map2"></div>
                <div class="map3"></div>
            </div>
            <div class="columnleft1">
                <div class="panel bar" id="1">
                    <h2>
                        因子探测器
                    </h2>
                    <div class="demo-tab-header layui-btn-container" id="tabHeader" style="text-align: center;">
                        <button class="layui-btn layui-btn-primary layui-this">渐变图</button>
                        <button class="layui-btn layui-btn-primary">雷达图</button>
                        <button class="layui-btn layui-btn-primary">标签3</button>
                    </div>
                    <div class="demo-tab-body" id="tabBody" style="width: 100%; height: 100%;">
                        <div class="chart" style="width: 600%; height: 450%;"></div>
                        <div class="chart2" style="width: 600%; height: 450%;"></div>
                    </div>
                    <script>
                        layui.use(function () {
                            var element = layui.element;
                            // 绑定自定义的 tab 元素
                            element.tab({
                                headerElem: '#tabHeader>.layui-btn',
                                bodyElem: '#tabBody>div'
                            });
                        });
                    </script>
                </div>
                <div class="panel line">
                    <h2>因子探测器原理</h2>
                    <div class="chart"></div>
                </div>

            </div>
            <div class="columnmiddle">
                <div class="panel bar2" ">
                    <h2>
            交互探测器
                    </h2>
                        <div class=" demo-tab-header layui-btn-container" id="tabHeader1" style="text-align: center;">
                    <button class="layui-btn layui-btn-primary layui-this">渐变图</button>
                    <button class="layui-btn layui-btn-primary">雷达图</button>
                    <button class="layui-btn layui-btn-primary">标签3</button>
                </div>
                <div class="demo-tab-body" id="tabBody1" style="width: 100%; height: 100%;">
                    <div class="chart" style="width: 4000%; height: 4500%;"></div>
                    <div class="chart2" style="width: 600%; height: 450%;"></div>
                </div>
                <script>
                    layui.use(function () {
                        var element = layui.element;
                        // 绑定自定义的 tab 元素
                        element.tab({
                            headerElem: '#tabHeader1>.layui-btn',
                            bodyElem: '#tabBody1>div'
                        });
                    });
                </script>
            </div>
            <div class="panel line2">
                <h2>交互探测器原理</h2>
                <div class="chart"></div>
            </div>

    </div>
    <div class="columnright1">

        <div class="panel bar1">
            <h2>生态探测器</h2>
            <div class="chart" style="position: relative; top: -50px;height: 100%;width: 100%;"></div>
        </div>
        <div class="panel line1">
            <h2>生态探测器原理</h2>
            <div class="chart"></div>

        </div>

    </div>
    </section>
    </div>





    <!-- <div class="c-tab-body">
            <div id="tab1" class="tab_content">
                <section class="mainbox">
                    <div class="columnleft">
                        <div class="panel bar">
                            <h2>
                                例图 <a href="javascript:;">2021</a>
                                <a href="javacript:;"> 2020</a>
                            </h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel line">
                            <h2>折线图-学习变化</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel pie">
                            <h2>饼形图-工程师年龄分布</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                    </div>
                    <div class="columnright">
                        <div class="panel bar1">
                            <h2>风险点排行</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel line1">
                            <h2>历史地面塌陷情况</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel pie1">
                            <h2>塌陷原因分类</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                    </div>
                </section>
            </div>
            <div id="tab2" class="tab_content">
                <section class="mainbox">
                    <div class="column">
                        <div class="panel bar">
                            <h2>
                                交互探测器
                            </h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel line">
                            <h2>因子探测器</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel pie">
                            <h2>生态探测器</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="no">
                            <div class="no-hd">
                                <button type="button" class="layui-btn layui-btn-primary"
                                    lay-on="iframe">Iframe</button>

                                <!-- <ul>
                                    <li>225811</li>
                                    <li>104563</li>
                                </ul> -->
    <!-- </div>
                            <div class="no-bd">
                                <ul>
                                    <li>塌陷事件总数</li>
                                    <li>今年塌陷事件总数</li>
                                </ul>
                            </div>
                        </div>
                        <div class="map">
                            <div class="chart"></div>
                            <div class="map1"></div>
                            <div class="map2"></div>
                            <div class="map3"></div>
                        </div>
                    </div>
                    <div class="column">
                        <div class="panel bar1">
                            <h2>风险点排行</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel line1">
                            <h2>111</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                        <div class="panel pie1">
                            <h2>塌陷原因分类</h2>
                            <div class="chart"></div>
                            <div class="panel-footer"></div>
                        </div>
                    </div>
                </section>
            </div>
            <div id="tab3" class="tab_content">
                <h1>This is pageC.</h1>
            </div>
            <div id="tab4" class="tab_content">
                <h1>This is pageD.</h1>
            </div>
            <div id="tab5" class="tab_content">
                <h1>This is pageE.</h1>
            </div>
            <div id="tab6" class="tab_content">
                <h1>This is pageF.</h1>
            </div>
        </div>  -->




    <script>
        layui.use(function () {
            var layer = layui.layer;
            var util = layui.util;
            // 批量事件
            util.on('lay-on', {
                alert: function () {
                    layer.alert('对话框内容');
                },
                confirm: function () {
                    layer.confirm('一个询问框的示例？', {
                        btn: ['确定', '关闭'] //按钮
                    }, function () {
                        layer.msg('第一个回调', { icon: 1 });
                    }, function () {
                        layer.msg('第二个回调', {
                            time: 20000, // 20s 后自动关闭
                            btn: ['明白了', '知道了']
                        });
                    });
                },
                msg: function () {
                    layer.msg('一段提示信息');
                },
                page: function () {
                    // 页面层
                    layer.open({
                        type: 1,
                        area: ['420px', '420px'], // 宽高
                        content: 'index/index3.html'
                    });
                },
                iframe: function () {
                    // iframe 层
                    layer.open({
                        type: 2,
                        title: 'iframe test',
                        shadeClose: true,
                        shade: 0.8,
                        area: ['800px', '800px'],
                        content: './index/index3.html' // iframe 的 url
                    });
                },
                iframe2: function () {
                    // iframe2 层
                    layer.open({
                        type: 2,
                        title: 'iframe test',
                        shadeClose: false,
                        shade: 0,
                        area: ['1200px', '800px'],
                        content: './index/index4.html' // iframe 的 url
                    });
                },
                load: function () {
                    var index = layer.load(0, { shade: false });
                    setTimeout(function () {
                        layer.close(index); // 关闭 loading
                    }, 5000);
                },
                tips: function () {
                    layer.tips('一个 tips 层', this, {
                        tips: 1
                    });
                },
                prompt: function () {
                    layer.prompt({ title: '密令输入框', formType: 1 }, function (pass, index) {
                        layer.close(index);
                        layer.prompt({ title: '文本输入框', formType: 2 }, function (text, index) {
                            layer.close(index);
                            alert('您输入的密令：' + pass + '；文本：' + text);
                        });
                    });
                },
                photots: function () {
                    layer.photos({
                        photos: {
                            "title": "Photos Demo",
                            "start": 0,
                            "data": [
                                {
                                    "alt": "layer",
                                    "pid": 1,
                                    "src": "https://unpkg.com/outeres/demo/layer.png",
                                },
                                {
                                    "alt": "壁纸",
                                    "pid": 3,
                                    "src": "https://unpkg.com/outeres/demo/000.jpg",
                                },
                                {
                                    "alt": "浩瀚宇宙",
                                    "pid": 5,
                                    "src": "https://unpkg.com/outeres/demo/outer-space.jpg",
                                }
                            ]
                        }
                    });
                }
            });
        });
    </script>
    <script src="js/flexible.js"></script>
    <script src="js/echarts.min.js"></script>
    <script src="js/index.js"></script>
    <script src="js/china.js"></script>
    <script src="js/echarts-map-jiangsu.js"></script>
    <script src="js/myMap.js"></script>


    <script>
        (function (fn) {
            fn();
            setInterval(fn, 1000);
        })(function () {
            var dt = new Date();
            document.querySelector(".showTime span").innerHTML =
                dt.getDate() + "日-" +
                dt.getHours() + "时" +
                dt.getMinutes() + "分" +
                dt.getSeconds() + "秒";
        });
    </script>

    <!-- 地图服务 -->
    <script>
        var host = window.isLocal ? window.server : "https://iserver.supermap.io";
        var map, resultLayer,
            url = host + "/iserver/services/map-china400/rest/maps/China";
        map = L.map('map', {
            preferCanvas: true,
            center: [34.27, 117.18],
            maxZoom: 18,
            minZoom:5,
            zoom: 7
        });
        new L.supermap.TiledMapLayer(url).addTo(map);
        loadHeatMap();

        function loadHeatMap() {
            var heatNumbers = 1, heatRadius = 30;
            var num = heatNumbers;
            num = (num > 0) ? num : 0;
            var radius = heatRadius;
            radius = (radius > 0) ? radius : 0;
            var heatPoints = [];
            $.ajax({
                url: "http://127.0.0.1:8000/daping/original_events",
                dataType: "json",
            }).done(function (data) {
                j = 0;
                for (i in data) {
                    heatPoints[j] = [data[i].fields.latitude, data[i].fields.longitude, 40];
                    j++;
                }
                resultLayer = L.heatLayer(heatPoints, {
                    radius: radius,
                    minOpacity: 0.5
                }).addTo(map);
            }).fail(function (jqXHR) {
                console.log("Ajax Fail: ", jqXHR.status, jqXHR.statusText);
            });
        }

    </script>

</body>

</html>